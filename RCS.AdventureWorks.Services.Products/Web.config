<?xml version="1.0" encoding="utf-8"?>

<configuration>
    <configSections>
        
        <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --></configSections>

    <appSettings>
        <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
    </appSettings>

    <!--
    For a description of web.config changes see http://go.microsoft.com/fwlink/?LinkId=235367.

    The following attributes can be set on the <httpRuntime> tag.
      <system.Web>
        <httpRuntime targetFramework="4.6" />
      </system.Web>
    -->
    <system.web>
        <compilation debug="true" targetFramework="4.7" />
        <httpRuntime targetFramework="4.6.2" />
    </system.web>

    <system.webServer>
        <modules runAllManagedModulesForAllRequests="true" />

        <!--
        To browse web app root directory during debugging, set the value below to true.
        Set to false before deployment to avoid disclosing web app folder information.
        -->
        <directoryBrowse enabled="true" />
    </system.webServer>

    <connectionStrings>
        <!--Note that currently the provider connection string is replaced with one to an Azure database during web publishing. Details are not in public source control.-->
        <!--This both applies when publishing the service to a the local network machine as to Azure.-->
        <!--TODO This might be turned in a debug/release distinction of this file.-->
        <add name="Entities" connectionString="metadata=res://*/ProductsModel.csdl|res://*/ProductsModel.ssdl|res://*/ProductsModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=RCS-VOSTRO\sqlexpress;initial catalog=AdventureWorks2014;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
    </connectionStrings>

    <!-- Note the dlls NEED to be directly in the bin directory, it does not work to build to separate Release and Debug directories. -->
    <system.serviceModel>
        <bindings>
            <!--
            Note that currently a self signed certifcate on the server is enough to let the https binding function and be accepted by the Android device.
            Installing the self signed certicate on the Android device failed anyway and might need additional steps like creating a CA with OpenSSL.
            -->
            <wsHttpBinding>
                <binding name="TransportSecurity">
                    <security mode="Transport">
                        <transport clientCredentialType="None" />
                    </security>
                </binding>
            </wsHttpBinding>

            <basicHttpBinding>
                <binding name="secureHttpBinding">
                    <security mode="Transport">
                        <transport clientCredentialType="None" />
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>

        <services>
            <service behaviorConfiguration="ProductsServiceBehavior" name="RCS.AdventureWorks.Services.Products.ProductsService">
                <endpoint address="ProductsServiceW" binding="wsHttpBinding" bindingConfiguration="TransportSecurity" contract="RCS.AdventureWorks.Services.Products.IProductsService" />
                <endpoint address="ProductsServiceB" binding="basicHttpBinding" bindingConfiguration="secureHttpBinding" contract="RCS.AdventureWorks.Services.Products.IProductsService" />
                <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
            </service>
        </services>

        <behaviors>
            <serviceBehaviors>
                <behavior name="ProductsServiceBehavior">
                    <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
                    <serviceMetadata httpsGetEnabled="true" />

                    <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
                    <serviceDebug includeExceptionDetailInFaults="true" />
                </behavior>
            </serviceBehaviors>
        </behaviors>
    </system.serviceModel>

    <entityFramework>
        <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
            <parameters>
                <parameter value="mssqllocaldb" />
            </parameters>
        </defaultConnectionFactory>
        <providers>
            <provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" />
        </providers>
    </entityFramework>
</configuration>